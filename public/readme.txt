		Simple OCR controller -SOC-

	バージョン:　　0.5.0（ベータ版）
	リリース:　　　2021-01-01
	開発・配布元:　ACT Laboratory　(https://actlab.org/)
	主要開発者:　　グレドラ　(https://guredora.com/)
　　ソフト種別:　　オープンソースソフトウェア　(GitHubリポジトリ:https://github.com/actlaboratory/SOC/)
　　ライセンス:　　GPLv2(or later)

		1  概要
Simple OCR controller(SOC)は、複雑な操作が必要な無償のOCRエンジンを使いやすくするツールです。
OCR(光学文字認識)は、画像に含まれる文字を読み取り、テキストに変換する技術です。
変換元の画像の状態や、使用するOCRエンジンによって、変換の正確さは変化します。
SOCを使用すると、JPEGなどの画像ファイル、画像が含まれるPDF文書などから文字を読み取り、簡単な操作でテキストデータとして保存することができます。
現在は、2種類のOCRエンジンに対応しています。
※このソフトは、現在開発中のベータ版です。思わぬ不具合が残っている可能性があります。完成品ではないことをご理解いただける方のみ、お試しください。ベータ版ではありますが、可能な限りのサポートは提供いたします。また、使った結果の感想等をお寄せいただけますと幸いです。

		2  動作確認環境
Windows10 64bitの環境で動作確認をしています。

		3  対応ファイル形式
現在、次のファイル形式に対応しています。
	.gif, .jpg, .png, .pdf
これ以外のファイル形式は読み込むことができません。

		4  インストールとアンインストール
	4-1  インストール
ダウンロードしたzipファイルを展開してください。
USBメモリなどに入れたままでも動作します。

	4-2  アンインストール
レジストリなどは使用していませんので、展開したフォルダを削除してください。
なお、送るメニューにショートカットを作成していた場合には、以下の方法で削除してください。
1. windows+Rキーを押し、[ファイル名を指定して実行]を開きます。
2. 「shell:SendTo」と入力して、Enterキーを押します。
3. 一覧からSOCを選択し、Deleteキーで削除します。


		5  対応しているエンジンについて
高速・高品質なGoogle documentsのOCRエンジンと、オープンソースで公開されているインターネット接続不要のtesseract-OCRに対応しています。
Google documentsのエンジンを利用するには、お持ちのGoogleアカウントをSOCと関連付ける必要があります。
tesseract-OCRは無制限に使用できますが、お使いのPCの内部でOCRを行うため、パフォーマンスなどはご使用のコンピュータの性能に依存します。

		6  使い方
	6-1  Googleアカウントを関連付ける
初回起動時はまだGoogleアカウントと関連付けが行われていないため、Google documentsのOCRエンジンを利用することができません。
関連付けを行わない場合でもtesseract-OCRは利用できます。
Googleアカウントとの関連付けは以下の手順で行います。
1. メニューバーの[設定]→[Googleと連携する]を選択します。
２． ブラウザを開くかどうかを確認するダイアログが表示されますので、[開始]を選択します。
3. 起動したブラウザで、お持ちのGoogleアカウントにログインします。
4. SOCへの権限の付与を確認するメッセージが表示されます。内容を確認し、[許可]を実行します。
5. チェックボックスにチェックが入っていることを確認し、問題なければもう一度[許可]ボタンを押します。
6. 認証官僚ページが表示されたことを確認し、ブラウザのウインドウを閉じます。
7. SOCのウインドウに、「認証が完了しました。」と表示されます。[完了]ボタンを押すと、認証作業が終了します。
※アカウントの情報は、SOCをインストールしたフォルダ内の「.credential」フォルダに保存されます。アカウントとSOCの関連付けを解除する場合は、このフォルダを削除してください。

	6-2  画面説明
起動した直後の画面には以下のものがあります。
ファイル一覧: 追加されたファイルがここに表示されます。Ctrl+Vを押すことでクリップボードにコピーしたファイルを張り付けることができます。マウスでのドラッグ＆ドロップにも対応しています。
追加: windows標準のファイル選択ダイアログを開き、選択したファイルをファイル一覧に追加します。Ctrl+Oでも同じダイアログを開くことができます。
削除: ファイル一覧で選択されている項目を一覧から削除します。このボタンを押しても、保存されているファイル自体は削除されません。ファイル一覧の項目の上でDelキーを押すことで同じ操作をすることもできます。
OCRエンジン選択: 使用するOCRエンジンを選択します。
モード: OCRエンジン選択でtesseract-OCRを選んだ場合にのみ表示され、tesseract-OCRのモードを選択することができます。詳細は後述します。
変換: OCRを開始します。

	6-3  OCRの実行
OCRを実行するには、画像ファイルを追加し、幾つかの設定を行う必要があります。

	6-3-1  ファイルを追加する
[追加]ボタンを押すか、ショートカットキーCtrl+Oを押すと、ファイル選択ダイアログが開きます。
このダイアログでは、一度に複数のファイルを選択できます。
また、ファイル一覧にフォーカスがある状態でCtrl+Vを押すと、クリップボードにコピーしたファイルを直接ファイル一覧に追加できます。対象ファイルをファイル一覧にドラッグアンドドロップしても、同様の結果が得られます。
ファイル一覧から項目を削除するには、削除したい項目を選択してから削除ボタンを押すか、Delキーを押します。

	6-3-2  OCRの設定を選択する
[OCRエンジン]のコンボボックスで、Googleとtesseract-OCRから利用するエンジンを選択します。
Googleを利用するには、インターネット接続とアカウントの関連付けが必要です。
インターネットが利用できない時やセキュリティを優先するときはtesseract-OCRを利用するとよいでしょう。
[tesseract-OCR]を選択した場合は、文字認識のモードを設定する必要があります。
横書き版と縦書き版がありますので、画像ファイルによって使い分けてください。
また、それぞれ低負荷版と通常版の2種類があります。
通常版: 制度優先でOCR処理を行います。多量のリソースを消費するため、環境によってはOCR実行中のパフォーマンスが低下する場合があります。
低負荷版: 速度優先でOCR処理を行います。通常版に比べて負荷は軽くなりますが、認識精度は低下します。

	6-3-3  変換の実行
[変換]ボタンを押すと、返還処理を開始します。
ファイル一覧に複数のファイルを追加した場合は、順番に変換が行われます。
変換終了後は、変換結果ダイアログが開きます。ここには、ファイル一覧と同じ順番で結果が連続して表示されます。
また、それぞれの変換元画像と同じフォルダに、画像ファイル名.txtというファイルでも変換結果が保存されています。

	6-3-6  OCRについての注意
1. tesseract-OCRでpdfファイルを変換する場合、途中で画像ファイルへの変換が行われるためかなりの時間がかかります。
2. Googleで変換した場合、レイアウトが崩れてしまうことがあります。
3. Googleの仕様上、大容量のpdfをOCRすることはできません。また、変換の為一時的にGoogleDriveに画像ファイルを保存します。GoogleDriveの空き容量にも注意してください。
4. 変換に際しては、使用するOCRエンジンに関係なく、PC本体に一時的に画像ファイルを保存する場合があります。

	6-7  設定画面について
メニューバーの[設定]→[設定画面を開く]から設定を行うことができます。
設定を保存してダイアログボックスを閉じるには、[OK]ボタンを押します。
設定を破棄してダイアログボックスを閉じるには、[キャンセル]ボタンを押します。
以下、各設定項目について説明します。
１．[一般]タブ
スクリーンリーダー: 使用するスクリーンリーダーを選択します。
配色: 画面の配色を設定します。
起動時にアップデートを確認: 起動時のアップデート確認の有無を設定します。
アップデート確認時のタイムアウト（秒）: アップデート確認時の通信がタイムアウトする時間を設定します。規定では、３秒に設定されています。
２．OCR
一時ファイルの場所: OCR時に使用する一時ファイルの保存先を設定します。
認識結果の保存先: 認識結果のテキストファイルの保存先を設定します。[指定したディレクトリ]を選択すると、保存先ディレクトリを設定できるようになります。

		7  注意事項
1． 連携されたGoogleアカウントの情報は、「.credential」ディレクトリ内に保存されます。このディレクトリ内のファイルを公開したり、他人に配布したりすると大変危険ですのでご注意ください。
2． このソフトウェアを利用した結果、もしくは利用できなかったことによって生じた直接・関節のあらゆる損害に対し、その予見可能性に関わらずソフトウェアの作者および開発・配布元は一切の責任を負いません。
3． このソフトウェアは無償かつ無保証で提供されています。ご要望・ご質問への対応についても、作者・配布元は対応の責任を負いません。
4． 本ソフトウェアの紹介・再配布は自由です。ただし、配布パッケージ全体を改変せずに配布してください。また、本ファイル末尾に記載の連絡先までご一報いただけますと幸いです。
5． Microsoftによるサポート期間内のOSをサポート対象とします。サポートが終了したOSでの利用に関するお問い合わせはご遠慮ください。
６．このソフトは、現在開発中のベータ版です。一部の機能が正しく動作しない可能性があることをご理解いただいた上でご利用ください。

		8  バージョンアップについて
このソフトウェアは、自動アップデート機能を搭載しています。ソフトウェア起動時にサーバと通信し、アップデートの有無を確認します。
アップデート情報が表示された場合には、指示に従ってアップデートを適用してください。
なお、ソフトウェアの最新情報はACT LaboratoryのウェブサイトやTwitterアカウントにて発信する予定です。

　ACT Laboratoryのウェブサイト：https://actlab.org/
　ACT LaboratoryTwitter：https://twitter.com/act_laboratory

		9  連絡先
このソフトウェアを利用しての感想やご要望、不具合のご報告などは、以下のメールアドレスまたは掲示板へご連絡ください。

　ACT Laboratory サポート：support@actlab.org
　ACT Laboratory 掲示板：https://actlab.org/bbs/
